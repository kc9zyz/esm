var opts={lines:12,angle:.15,lineWidth:.33,pointer:{length:.54,strokeWidth:.035,color:"#000000"},limitMax:"false",colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:true};var energy={"Cell Phone Charger":10,Laptop:70,"Window AC Unit":600,Refrigerator:200,"Washing Machine":700,Microwave:1500,Blender:750,Toaster:1e3,"Easy Bake Oven":100,"George Foreman Grill":760,Dishwasher:1200,"Panini Press":1400,"Quesadilla Maker":900,"Waffle Iron":1e3,"Pancake Skillet":1e3,PS4:150,"XBOX One":120,"Wii U":35,"Space Heater":1500};getEnergyExample=function(output){var energyArray=Array();for(key in energy){if(key!=this.previousExample){energyArray.push([key,energy[key]])}}for(var i=0;i<1e3;i++){var first=Math.floor(Math.random()*energyArray.length);var second=Math.floor(Math.random()*energyArray.length);var temp=energyArray[first];energyArray[first]=energyArray[second];energyArray[second]=temp}do{var chosenOne=energyArray.pop();if(!chosenOne){break}}while(chosenOne[1]>output);if(chosenOne){var numberPowered=Math.floor(output/chosenOne[1]);if(numberPowered>1){var chosenText=chosenOne[0];if(chosenText.slice(-1)=="s"){chosenText+="es"}else{chosenText+="s"}}else{var chosenText=chosenOne[0]}$("#energyComp").html(""+numberPowered+" "+chosenText)}else{$("#energyComp").html("None of the devices on our list without batteries")}};getCurrentData=function(caller){$.ajax({url:"data/?asset=current-data",success:function(result){var more=[result.totalOutput,result.totalPanel,result.totalShingle,result.panelAngle,result.heading,result.boxTemp,result.windSpeed];updateGauge(caller,result.panelOutput,result.shingleOutput,more,result.timestamp)},error:function(jq,err){console.log(err)}})};var targetPanel=document.getElementById("current-data-panel");var targetShingle=document.getElementById("current-data-shingle");updateGauge=function(caller,panel,shingle,more,time){if(typeof updateGauge.firstTime=="undefined"){updateGauge.firstTime=1}if(caller=="waypoint"&&updateGauge.firstTime==1){updateGauge.firstTime=0;this.gauge1=new Gauge(targetPanel).setOptions(opts);this.gauge2=new Gauge(targetShingle).setOptions(opts);this.gauge1.maxValue=220;this.gauge2.maxValue=220;this.gauge1.animationSpeed=13;this.gauge2.animationSpeed=13;this.gauge1.setTextField(document.getElementById("current-data-panel-textfield"));this.gauge2.setTextField(document.getElementById("current-data-shingle-textfield"));this.gauge1.set(1);this.gauge2.set(1);if(!isNaN(panel)&&!isNaN(shingle)){console.log("panel: "+panel+" Shingle: "+shingle);this.gauge1.set(panel);this.gauge2.set(shingle)}setInterval(function(){getCurrentData("time")},1e4)}else if(caller=="time"&&updateGauge.firstTime==0){if(isNaN(panel)){panel=0}if(isNaN(shingle)){shingle=0}if(this.gauge1.value!=panel){this.gauge1.animationSpeed=1;if(panel==0){this.gauge1.set(1)}else{this.gauge1.set(panel)}}if(this.gauge2.value!=shingle){this.gauge2.animationSpeed=1;if(shingle==0){this.gauge2.set(1)}else{this.gauge2.set(shingle)}}}if(panel==0){$("#current-data-panel-textfield").html("0")}if(shingle==0){$("#current-data-shingle-textfield").html("0")}$("#powerLine").fadeOut(1500,function(){$("#powerLine").fadeIn();getEnergyExample(more[0])});$("#totalWatts").html(""+more[0]+"&nbsp;W");$("#totalPanel").html(""+more[1]+"&nbsp;W");$("#totalShingle").html(""+more[2]+"&nbsp;W");$("#panelAngle").html(""+more[3]+"&nbsp;°");$("#heading").html(""+more[4]+"&nbsp;°");$("#boxTemp").html(""+more[5]+"&nbsp;°F");$("#windSpeed").html(""+more[6]+"&nbsp;MPH");a=new Date(time);b=new Date;if(b-a>20*60*1e3){$("#system-live").html("System was last live "+a.toLocaleString())}else{$("#system-live").html("System is live")}};getCurrentData("waypoint");
