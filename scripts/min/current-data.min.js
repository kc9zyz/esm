var opts={lines:12,angle:.15,lineWidth:.33,pointer:{length:.54,strokeWidth:.035,color:"#000000"},limitMax:"false",colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:true};getCurrentData=function(caller){$.ajax({url:"data/?asset=current-data",success:function(result){var more=[result.totalOutput,result.panelAngle,result.heading];updateGauge(caller,result.panelOutput,result.shingleOutput,more,result.timestamp)},error:function(jq,err){console.log(err)}})};var targetPanel=document.getElementById("current-data-panel");var targetShingle=document.getElementById("current-data-shingle");updateGauge=function(caller,panel,shingle,more,time){if(typeof updateGauge.firstTime=="undefined"){updateGauge.firstTime=1}if(caller=="waypoint"&&updateGauge.firstTime==1){updateGauge.firstTime=0;this.gauge1=new Gauge(targetPanel).setOptions(opts);this.gauge2=new Gauge(targetShingle).setOptions(opts);this.gauge1.maxValue=400;this.gauge2.maxValue=400;this.gauge1.animationSpeed=13;this.gauge2.animationSpeed=13;this.gauge1.setTextField(document.getElementById("current-data-panel-textfield"));this.gauge2.setTextField(document.getElementById("current-data-shingle-textfield"));this.gauge1.set(0);this.gauge2.set(0);this.gauge1.set(panel);this.gauge2.set(shingle);setInterval(function(){getCurrentData("time")},2e3)}else if(caller=="time"&&updateGauge.firstTime==0){if(this.gauge1.value!=panel){this.gauge1.animationSpeed=1;this.gauge1.set(panel)}if(this.gauge2.value!=shingle){this.gauge2.animationSpeed=1;this.gauge2.set(shingle)}}$("#totalWatts").html(""+more[0]+" W");$("#panelAngle").html(""+more[1]+" °");$("#heading").html(""+more[2]+" °");a=new Date(time);b=new Date;if(b-a>20*60*1e3){$("#system-live").html("System was last live "+a.toLocaleString())}else{$("#system-live").html("System is live")}};getCurrentData("waypoint");
